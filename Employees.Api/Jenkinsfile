node {
   stage('init') {
      checkout scm
   }
   stage('restore') {   
    sh '''
         dotnet restore Employees.Api/Employees.Api.sln
      '''
  }
  stage('Tests') {   
    sh '''
         dotnet test Employees.Api/Employees.Api.sln
      '''
  }
  stage('Publish') {   
  steps {
  sh(script: "dotnet publish -c Release -o todo Employees.Api/Employees.Api.sln ", returnStdout: true)
	}   
  }
   stage('deploy') {
   azureWebAppPublish azureCredentialsId: 
	  env.AZURE_CRED_ID,
      resourceGroup: env.RES_GROUP, 
	  appName: env.WEB_APP, 
	  sourceDirectory: "todo"
  }
}